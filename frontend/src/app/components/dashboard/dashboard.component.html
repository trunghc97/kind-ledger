<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0">
          <i class="fas fa-tachometer-alt text-primary me-2"></i>
          Dashboard
        </h1>
        <button class="btn btn-outline-primary" (click)="refresh()">
          <i class="fas fa-sync-alt me-1"></i>
          Làm mới
        </button>
      </div>

      <!-- Error Message -->
      <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i>
        {{ error }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>

      <!-- Loading Spinner -->
      <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Đang tải...</span>
        </div>
        <p class="mt-2 text-muted">Đang tải dữ liệu từ blockchain...</p>
      </div>

      <!-- Dashboard Content -->
      <div *ngIf="!loading && !error">
        <!-- Statistics Cards -->
        <div class="row mb-4">
          <div class="col-md-4">
            <div class="card bg-primary text-white">
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div>
                    <h4 class="card-title">{{ campaigns.length }}</h4>
                    <p class="card-text">Tổng số chiến dịch</p>
                  </div>
                  <div class="align-self-center">
                    <i class="fas fa-hand-holding-heart fa-2x"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card bg-success text-white">
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div>
                    <h4 class="card-title">{{ formatCurrency(totalDonations) }}</h4>
                    <p class="card-text">Tổng quyên góp</p>
                  </div>
                  <div class="align-self-center">
                    <i class="fas fa-coins fa-2x"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card bg-info text-white">
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div>
                    <h4 class="card-title">{{ getCompletedCampaignsCount() }}</h4>
                    <p class="card-text">Chiến dịch hoàn thành</p>
                  </div>
                  <div class="align-self-center">
                    <i class="fas fa-check-circle fa-2x"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Campaigns List -->
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h5 class="card-title mb-0">
                  <i class="fas fa-list me-2"></i>
                  Danh sách chiến dịch
                </h5>
              </div>
              <div class="card-body">
                <div *ngIf="campaigns.length === 0" class="text-center py-4">
                  <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                  <p class="text-muted">Chưa có chiến dịch nào</p>
                </div>

                <div *ngFor="let campaign of campaigns" class="card mb-3">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-8">
                        <h6 class="card-title">{{ campaign.name }}</h6>
                        <p class="card-text text-muted">{{ campaign.description }}</p>
                        <div class="d-flex align-items-center">
                          <span class="badge" 
                                [ngClass]="campaign.status === 'COMPLETED' ? 'bg-success' : 'bg-primary'">
                            {{ campaign.status === 'COMPLETED' ? 'Hoàn thành' : 'Đang mở' }}
                          </span>
                          <small class="text-muted ms-2">
                            <i class="fas fa-user me-1"></i>
                            {{ campaign.owner }}
                          </small>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="text-end">
                          <div class="mb-2">
                            <strong>{{ formatCurrency(campaign.raised) }}</strong>
                            <small class="text-muted">/ {{ formatCurrency(campaign.goal) }}</small>
                          </div>
                          <div class="progress mb-2" style="height: 8px;">
                            <div class="progress-bar" 
                                 [style.width.%]="getProgressPercentage(campaign)"
                                 [ngClass]="campaign.status === 'COMPLETED' ? 'bg-success' : 'bg-primary'">
                            </div>
                          </div>
                          <small class="text-muted">
                            {{ getProgressPercentage(campaign) | number:'1.1-1' }}% hoàn thành
                          </small>
                        </div>
                      </div>
                    </div>
                    <div class="row mt-3">
                      <div class="col-12">
                        <div class="d-flex justify-content-between">
                          <small class="text-muted">
                            <i class="fas fa-calendar me-1"></i>
                            Tạo: {{ campaign.createdAt | date:'dd/MM/yyyy HH:mm' }}
                          </small>
                          <div>
                            <a [routerLink]="['/campaigns', campaign.id]" 
                               class="btn btn-sm btn-outline-primary me-2">
                              <i class="fas fa-eye me-1"></i>
                              Xem chi tiết
                            </a>
                            <a [routerLink]="['/donate', campaign.id]" 
                               class="btn btn-sm btn-success"
                               *ngIf="campaign.status !== 'COMPLETED'">
                              <i class="fas fa-heart me-1"></i>
                              Quyên góp
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
